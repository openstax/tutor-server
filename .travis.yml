branches:
  only:
    - master
sudo: false
language: ruby
rvm:
  - "2.3.1"
addons:
  postgresql: "9.4"
env:
  global:
    - OXT_DB_USER=postgres
    - OXT_DB_PASS=
    - OXT_TEST_DB=travis_ci_test
    - PARALLEL_TEST_PROCESSORS=2
    - DEMO_MAX_PROCESSES=0
    - DISPLAY=:99.0
cache: bundler
bundler_args: --without production --retry=6
before_script:
  - sh -e /etc/init.d/xvfb start
  - bundle exec rake --trace parallel:create parallel:load_schema parallel:seed
script:
  - bundle exec parallel_rspec ./spec
